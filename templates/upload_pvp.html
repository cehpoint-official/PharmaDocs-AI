{% extends "base.html" %}
{% block title %}Upload PVP Template - PharmaDocs AI Platform{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-10">

    <!-- Header Section -->
    <div class="mb-10 text-center">
        <div
            class="flex items-center justify-center gap-2 text-xs font-bold text-slate-400 uppercase tracking-widest mb-4">
            <a href="{{ url_for('pv.list_templates') }}" class="hover:text-indigo-600 transition-colors">Protocol
                Repository</a>
            <i class="fas fa-chevron-right text-[8px]"></i>
            <span class="text-indigo-600">Template Ingestion</span>
        </div>
        <h1 class="text-3xl font-display font-black text-slate-900 tracking-tight">AI-Powered PVP Upload</h1>
        <p class="text-sm font-medium text-slate-500 mt-2 max-w-xl mx-auto leading-relaxed">
            Standardize your validation process. Upload a pharmaceutical PVP document, and our AI will automatically
            structure the parameters for report generation.
        </p>
    </div>

    <div class="card-premium h-full">
        <div class="px-8 py-6 border-b border-slate-100 bg-slate-50/50 flex items-center justify-between">
            <h2 class="text-xs font-black text-slate-900 uppercase tracking-wider">Template Configuration</h2>
            <i class="fas fa-robot text-indigo-600 animate-pulse"></i>
        </div>

        <form method="POST" enctype="multipart/form-data" class="p-8 space-y-8">
            <!-- Template Name -->
            <div class="space-y-2">
                <label class="label-saas">Canonical Template Name <span class="text-red-500">*</span></label>
                <input type="text" name="template_name" required class="input-saas"
                    placeholder="e.g. Paracetamol Tablet Compression PVP (v1.2)">
                <p class="text-[10px] font-bold text-slate-400 uppercase tracking-tighter">Use a nomenclature that
                    clearly identifies product and version.</p>
            </div>

            <!-- File Upload -->
            <div class="space-y-2">
                <label class="label-saas text-center block w-full">Process Validation Protocol (PDF) <span
                        class="text-red-500">*</span></label>
                <div class="mt-2 group relative">
                    <div
                        class="w-full min-h-[220px] bg-slate-50/50 border-2 border-dashed border-slate-200 rounded-[2rem] flex flex-col items-center justify-center p-8 transition-all hover:border-indigo-300 hover:bg-slate-50">
                        <div
                            class="w-16 h-16 bg-white border border-slate-100 rounded-2xl flex items-center justify-center text-indigo-600 shadow-soft group-hover:scale-110 group-hover:rotate-3 transition-transform mb-4">
                            <i class="fas fa-cloud-upload-alt text-2xl"></i>
                        </div>
                        <div class="text-center">
                            <p class="text-sm font-black text-slate-900 leading-tight">Drop protocol here or <span
                                    class="text-indigo-600 hover:underline cursor-pointer">browse</span></p>
                            <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-2">Maximum file
                                size: 50MB (PDF Only)</p>
                        </div>
                        <input type="file" name="pvp_file" accept=".pdf" required
                            class="absolute inset-0 w-full h-full opacity-0 cursor-pointer" id="pvp-file-input">
                    </div>
                    <p id="file-name"
                        class="text-center text-[11px] font-black text-emerald-600 uppercase tracking-widest mt-4 min-h-[1rem]">
                    </p>
                </div>
            </div>

            <!-- AI extraction Intelligence -->
            <div class="bg-indigo-50/50 border border-indigo-100 rounded-2xl p-6 flex items-start gap-4">
                <div
                    class="w-10 h-10 bg-indigo-100 text-indigo-600 rounded-xl flex items-center justify-center flex-shrink-0">
                    <i class="fas fa-brain text-sm"></i>
                </div>
                <div>
                    <h4 class="text-xs font-black text-slate-900 uppercase tracking-wider mb-2">Automated Extraction
                        Logic</h4>
                    <p class="text-[11px] font-medium text-slate-600 leading-relaxed mb-3">Our neural engine will scan
                        the protocol to identify and catalog:</p>
                    <ul class="grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2">
                        <li
                            class="flex items-center gap-2 text-[10px] font-bold text-slate-500 uppercase tracking-tighter">
                            <i class="fas fa-check-circle text-emerald-500"></i> Critical Parameters (CPP)
                        </li>
                        <li
                            class="flex items-center gap-2 text-[10px] font-bold text-slate-500 uppercase tracking-tighter">
                            <i class="fas fa-check-circle text-emerald-500"></i> Quality Attributes (CQA)
                        </li>
                        <li
                            class="flex items-center gap-2 text-[10px] font-bold text-slate-500 uppercase tracking-tighter">
                            <i class="fas fa-check-circle text-emerald-500"></i> Acceptance Criteria
                        </li>
                        <li
                            class="flex items-center gap-2 text-[10px] font-bold text-slate-500 uppercase tracking-tighter">
                            <i class="fas fa-check-circle text-emerald-500"></i> Equipment Registry
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="flex flex-col sm:flex-row gap-4 pt-4">
                <button type="submit" class="flex-1 btn-primary-saas py-4 text-xs shadow-xl shadow-indigo-100">
                    <i class="fas fa-robot mr-2"></i> Ingest & Structure Protocol
                </button>
                <a href="{{ url_for('pv.list_templates') }}"
                    class="sm:w-32 flex items-center justify-center text-[10px] font-black text-slate-400 uppercase tracking-widest hover:text-slate-900 transition-colors">
                    Discard
                </a>
            </div>
        </form>
    </div>
</div>

<script>
    document.getElementById('pvp-file-input').addEventListener('change', function (e) {
        const fileName = e.target.files[0]?.name;
        if (fileName) {
            document.getElementById('file-name').innerHTML = '<i class="fas fa-check-circle mr-1"></i> Protocol Detected: ' + fileName;
            document.getElementById('file-name').classList.remove('text-emerald-600');
            document.getElementById('file-name').classList.add('text-indigo-600');
        }
    });
</script>
{% endblock %}